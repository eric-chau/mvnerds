{% extends 'MVNerdsLaunchSiteBundle::layout.html.twig' %}

{% set admin_mode = false %}
{% if app.user != null %}
	{% if user.getId() == app.user.getId() %}
		{% set admin_mode = true %}
	{% endif %}
{% endif %}

{% block title %}
	{% if admin_mode == false %}
		{{ user.getUsername() }} - Profil d'invocateur | MVNerds
	{% else %}
		Mon profil - {{ user.getUsername() }} | MVNerds
	{% endif %}
{% endblock %}
		
{% block css %}
	{{ parent() }}

	<link href="{{ asset('css/profile/profile.css') }}" rel="stylesheet" type="text/css">
	<link href="{{ asset('css/item_builder/listing-page.css') }}" rel="stylesheet" type="text/css">
	<link href="{{ asset('css/item_builder/modal.css') }}" rel="stylesheet" type="text/css">
	<link href="{{ asset('css/champion_handler/champion-square25-sprite.css') }}" rel="stylesheet" type="text/css">
{% endblock %}
	
{% block javascripts %}
	{{ parent() }}
	
	<script type="text/javascript" src="{{ asset('/js/bootstrap/bootstrap-popover.js') }}"></script>
	<script type="text/javascript" src="{{ asset('js/profile/profile.js') }}"></script>
	<script type="text/javascript" src="{{ asset('js/item_handler/item_builder/dl-modal.js') }}"></script>
{% endblock %}

{% block body_main_content %}
	<div class="body-container summoner-profile">
		<img src="{{ asset('images/avatar/ro0ny.jpg') }}" class="avatar" />
		<h1>{{ user.getUsername() }}</h1>
		<p class="gray-color">Inscrit depuis le {{ user.getCreatedAt()|date('d/m/Y') }}</p>
		<p class="gray-color no-margin">Au sein de la communauté MVNerds, {{ user.getUsername() }} est :
			<ul class="gray-color">
				{% for role in user.getRoles() %}
					<li>{{ role|trans }}</li>
				{% endfor %}
			</ul>
		</p>
		<div class="clearfix"></div>
		
		{% if admin_mode %}
			<h2>Mes préférences utilisateurs</h2>
			<div class="user-custom-parameters-container">
				<div class="module-block">
					<h4>PIMP MY RECOMMENDED ITEMS</h4>

					<form action="#" method="POST">
						<div>
							{{ form_label(form.lolDirectory) }}
							{{ form_widget(form.lolDirectory) }}
							<a href="#" class="reset-field"><i class="icon-remove-circle"></i></a>
							<a href="#" class="save-field disabled" data-preference="LEAGUE_OF_LEGENDS_DIRECTORY"><i class="icon-ok-circle"></i></a>
							<img src="{{ asset('images/commons/loader16-bg-141414.gif') }}" class="loader hide" />
						</div>

						{{ form_rest(form) }}
					</form>
				</div>
			</div>
		{% endif %}
		
		<h2>Listes d'objets conseillés personnalisées</h2>
		{% if user_items_builds|length > 0 %}
			{% if admin_mode == false %}
				{% include 'MVNerdsItemHandlerBundle:ItemBuilder:item_table.html.twig' with {'item_builds': user_items_builds}  %}
			{% else %}
				{% include 'MVNerdsItemHandlerBundle:ItemBuilder:item_table.html.twig' with {'item_builds': user_items_builds, 'admin_mode': true}  %}
			{% endif %}
		{% else %}
			<p class="empty-list">{{ user.getUsername() }} n'a pas encore enregistré de liste d'objet conseillé.</p>
		{% endif %}
		
		{% include 'MVNerdsItemHandlerBundle:Modal:change_lol_directory_modal.html.twig' %}
	</div>
{% endblock %}
