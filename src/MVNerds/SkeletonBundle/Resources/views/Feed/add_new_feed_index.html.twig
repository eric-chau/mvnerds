{% extends 'MVNerdsSkeletonBundle:Common:layout_alt.html.twig' %}

{% block css %}
	{{ parent() }}

	<link rel="stylesheet" href="{{ asset('medias/css/feed/create-page.css') }}">
{% endblock %}
	
{% block javascripts %}
	<script type="text/javascript" src="{{ asset('medias/js/bootstrap/bootstrap-typeahead.js') }}"></script>
	<script type="text/javascript">
		$(document).ready(function() {
			superTags = $('input#tags-input').data('source');
			$hiddenSuperTagsInput = $('input#{{ form.feed_tags.vars.id }}');
			$('ul.tags-container').on('click', 'li.tag a', function(event) {
				event.preventDefault();
				superTag = $(this).parent().find('em').html();
				superTags.push(superTag);
				$(this).parent().remove();
				$hiddenSuperTagsInput.val($hiddenSuperTagsInput.val().replace(superTag + ',', ''));
			});
			
			$('input#tags-input').on('keypress', function(event) {
				if (event.which == 13) {
					event.preventDefault();
					
					userValue = $(this).val();
					valuePosition = $.inArray(userValue, superTags);
					if (valuePosition !== -1) {
						if ($('li.tag').length > 0) {
							$('<li class="tag"><em>'+ userValue +'</em><a href="#">x</a></li>').insertAfter('li.tag:last');
						}
						else {
							$('<li class="tag"><em>'+ userValue +'</em><a href="#">x</a></li>').prependTo('ul.tags-container');
						}
					}
					
					superTags.splice(valuePosition, 1);
					$(this).val('');
					
					$hiddenSuperTagsInput.val($hiddenSuperTagsInput.val() + userValue + ',');
				}
			});
			
			$('select').on('change', function() {
				$(this).parent().find('div.selectbox-widget span.option-value').html($(this).find(":selected").text());
			});
		});
	</script>
{% endblock %}

{% block main_content %}
	<div class="new-content-container">
		<p>
			Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque tristique odio sed justo bibendum, in faucibus turpis tempus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Nam erat orci, accumsan nec imperdiet nec, tincidunt sed risus. Maecenas mollis pretium nibh id suscipit. Vestibulum suscipit consectetur leo, eu rutrum augue egestas dignissim. Morbi purus nibh, pellentesque at augue eget, egestas interdum urna. Nam suscipit, urna vitae luctus rutrum, metus ipsum placerat turpis, quis commodo felis ipsum ac dolor. Nunc congue ornare semper. Duis in leo a ipsum lobortis consequat at a diam. Pellentesque sed nisl sollicitudin, pretium velit a, accumsan dui. Maecenas feugiat vitae nunc at dapibus.
		</p>
		{{ form_start(form) }}
			{{ form_errors(form) }}
			
			<div class="form-row">
				{{ form_label(form.lang, 'feed.create.form.language'|trans) }}
				{{ form_errors(form.lang) }}
				<div class="custom-selectbox-wrapper">
					{{ form_widget(form.lang) }}
					<div class="selectbox-widget">
						<span class="option-value">{{ form.lang.vars.choices.0.label }}</span>
						<i class="icon-chevron-down"></i>
					</div>
				</div>
			</div>
			
			<div class="form-row">
				{{ form_label(form.type_unique_name.unique_name, 'feed.create.form.type'|trans) }}
				{{ form_errors(form.type_unique_name.unique_name) }}
				<div class="custom-selectbox-wrapper">
					{{ form_widget(form.type_unique_name.unique_name) }}
					<div class="selectbox-widget">
						<span class="option-value">{{ form.type_unique_name.unique_name.vars.choices.0.label }}</span>
						<i class="icon-chevron-down"></i>
					</div>
				</div>
			</div>
		
			<div class="form-row">
				<label for="tags-input">Tags</label>
				<div class="tags-widget">
					<ul class="tags-container">
						<li class="search-field">
							<input type="text" id="tags-input" class="typeahead-anchor" data-provide="typeahead" data-minLength="0" data-source="{{ super_tags|json_encode() }}" placeholder="Choisissez au moins un tag" />
						</li>
					</ul>
				</div>
			</div>
			
			<div class="form-row">
				{{ form_label(form.title, 'feed.create.form.title'|trans) }}
				{{ form_errors(form.title) }}
				{{ form_widget(form.title) }}
			</div>
			
			<div class="form-row">
				{{ form_label(form.content, 'feed.create.form.content'|trans) }}
				{{ form_errors(form.content) }}
				{{ form_widget(form.content, { 'attr': {'rows': 15} }) }}
			</div>
			
			<div class="form-row">
				<input type="submit" value="{{ 'feed.create.form.submit_button'|trans }}" />
			</div>
		{{ form_end(form) }}
	</div>
{% endblock %}